<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>TO UGM 2026</title>
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="assets/img/logo_ugm.png">
    <meta name="theme-color" content="#0C1B2E">

    <link href="https://fonts.googleapis.com/css2?family=Mochiy+Pop+P+One&family=Fredoka+One&display=swap" rel="stylesheet">
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        :root {
            --bg-primary: #0C1B2E;   
            --bg-secondary: #1A2A3E; 
            --bg-overlay: rgba(12, 27, 46, 0.30); 
            --accent-gold: #D4AF37;   
            --accent-orange: #E65C4A; 
            --accent-red: #ff4757;
            --accent-blue: #4A90E2;   
            --text-primary: #FFFFFF;
            --text-secondary: #E0E0E0; 
            --glass-bg: rgba(20, 30, 48, 0.70); 
            --glass-border: rgba(255, 255, 255, 0.2); 
            --font-family: 'Fredoka One', cursive, sans-serif;
        }

        body {
            font-family: var(--font-family);
            margin: 0; padding: 0; 
            color: var(--text-primary);
            background-image: url('assets/img/background.jpg'); 
            background-attachment: fixed;
            background-position: center; background-size: cover;
            min-height: 100vh;
            display: flex; flex-direction: column;
            margin-bottom: 0 !important;
        }

        body::before { content: ""; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: var(--bg-overlay); z-index: -1; }
        
        .container { 
            max-width: 800px; margin: auto; position: relative; flex: 1; width: 100%; box-sizing: border-box;
            padding: 15px; padding-bottom: 0;
        }

        /* GLASS CARD */
        .glass-card {
            background: var(--glass-bg);
            backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px);
            border: 1px solid var(--glass-border);
            border-radius: 16px; padding: 20px; margin-bottom: 20px;
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.2);
            position: relative;
            overflow: visible;
        }

        /* HEADER AREA */
        .header-card { padding-bottom: 30px; margin-top: 10px; } 
        .header-top { display: flex; justify-content: space-between; align-items: flex-start; z-index: 2; position: relative; }
        
        .app-title { 
            font-family: 'Mochiy Pop P One', cursive; 
            font-size: 1.6em; 
            color: var(--accent-gold); margin: 0; 
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8); line-height: 1.2; 
            flex: 1;
        }
        
        .quote-text { font-size: 0.85em; color: var(--text-secondary); font-style: italic; margin-top: 5px; font-weight: normal; opacity: 0.9; line-height: 1.4; }
        .btn-settings-img { width: 38px; height: 38px; object-fit: contain; cursor: pointer; filter: drop-shadow(0 2px 4px rgba(0,0,0,0.5)); transition: transform 0.2s; margin-top: 5px; }
        .btn-settings-img:active { transform: scale(0.9); }

        /* Health Bar */
        .health-bar-container { position: absolute; bottom: 0; left: 0; right: 0; height: 22px; background: rgba(0,0,0,0.5); border-radius: 0 0 16px 16px; overflow: hidden; border-top: 1px solid rgba(255,255,255,0.1); }
        .health-bar-fill { height: 100%; background: linear-gradient(90deg, #ff4757, #e84118); width: 0%; display: flex; align-items: center; justify-content: center; transition: width 1s ease, background 1s ease; }
        .health-text { font-size: 0.7em; color: white; font-weight: bold; position: absolute; top:0; width: 100%; text-align: center; line-height: 22px; text-shadow: 1px 1px 3px rgba(0,0,0,0.8); letter-spacing: 0.5px; z-index: 2; }

        h3 { color: var(--accent-gold); margin-top: 0; border-bottom: 1px dashed var(--accent-gold); padding-bottom: 10px; font-size: 1.2em; display: flex; align-items: center; gap: 10px; }
        .icon-title { width: 28px; height: 28px; object-fit: contain; }

        /* --- TARGET CARD --- */
        .target-card-contract {
            background-color: rgba(0,0,0,0.6); border: 2px solid var(--accent-gold); border-radius: 16px; padding: 20px;
            position: relative; overflow: hidden; box-shadow: 0 10px 30px rgba(0,0,0,0.4); margin-bottom: 20px;
            min-height: 120px; display: flex; align-items: center; justify-content: space-between;
        }
        .target-card-contract::before {
            content: ""; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
            background-image: url('assets/img/target_bg.png'); background-size: cover; background-position: center; opacity: 0.5; z-index: 0;
        }
        .target-info { z-index: 2; position: relative; max-width: 65%; }
        .target-score-box { z-index: 2; position: relative; text-align: right; background: rgba(0,0,0,0.5); padding: 10px 15px; border-radius: 12px; border: 1px solid rgba(255,255,255,0.3); backdrop-filter: blur(5px); }
        .target-label { color: var(--accent-orange); font-size: 0.65em; letter-spacing: 2px; text-transform: uppercase; font-weight: 800; margin-bottom: 5px; border-bottom: 2px solid var(--accent-orange); display: inline-block; padding-bottom: 2px; }
        .target-prodi { font-size: 1.6em; color: var(--accent-gold); margin: 5px 0 0 0; text-shadow: 0 2px 4px rgba(0,0,0,0.8); font-family: 'Mochiy Pop P One', cursive; line-height: 1.1; }
        .target-univ { font-size: 0.8em; color: #ccc; font-weight: normal; margin-top: 5px; font-style: italic; }
        .score-label-small { font-size: 0.6em; color: #aaa; display: block; letter-spacing: 1px; }
        .score-value-big { font-size: 1.8em; color: #fff; font-weight: 800; }

        /* RAPOR GRID & CHARTS */
        .rapor-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-top: 15px; }
        .subtest-card { background: rgba(0, 0, 0, 0.3); border: 1px solid rgba(255,255,255,0.1); border-radius: 12px; padding: 10px 5px; text-align: center; display: flex; flex-direction: column; align-items: center; position: relative; }
        .subtest-card:nth-child(7) { grid-column: 2; }
        .circular-chart { display: block; margin: 5px auto; position: relative; width: 65px; height: 65px; border-radius: 50%; background: conic-gradient(var(--accent-gold) 0%, transparent 0%); display: flex; justify-content: center; align-items: center; }
        .chibi-container { width: 52px; height: 52px; background: rgba(0,0,0,0.5); border-radius: 50%; overflow: hidden; display: flex; justify-content: center; align-items: center; position: relative; }
        .chibi-face { width: 100%; height: 100%; object-fit: cover; }
        .percent-badge { position: absolute; bottom: -5px; background: var(--accent-gold); color: #000; font-size: 0.6em; font-weight: bold; padding: 2px 6px; border-radius: 10px; border: 1px solid #fff; box-shadow: 0 2px 5px rgba(0,0,0,0.5); }
        .subtest-title { font-size: 0.75em; font-weight: bold; color: var(--accent-gold); margin-bottom: 2px; }

        .chart-wrapper {
            position: relative; height: 250px; width: 100%; margin-bottom: 20px;
        }

        /* FOOTER */
        .footer-wrapper { width: 100%; margin-top: 30px; display: flex; justify-content: center; position: relative; z-index: 0; padding-bottom: 0; margin-bottom: 0; }
        .footer-scene-img { width: 100%; height: auto; display: block; object-fit: cover; -webkit-mask-image: linear-gradient(to bottom, transparent 0%, black 25%); mask-image: linear-gradient(to bottom, transparent 0%, black 25%); opacity: 0.95; }

        /* INPUTS */
        input, select { width: 100%; padding: 12px; margin-bottom: 12px; border: 1px solid var(--accent-gold); border-radius: 8px; box-sizing: border-box; background: rgba(0,0,0,0.4); color: var(--text-primary); font-family: var(--font-family); }
        input:focus, select:focus { outline: none; border-color: var(--accent-orange); background: rgba(0,0,0,0.7); }
        .manual-calc-box { background: rgba(0,0,0,0.2); border-radius: 12px; padding: 15px; border: 1px solid rgba(255,255,255,0.1); }
        .col-header { display: grid; grid-template-columns: 1.5fr 1fr 1fr 0.8fr; gap: 5px; margin-bottom: 10px; font-size: 0.7em; color: var(--text-secondary); text-align: center; }
        .score-row { display: grid; grid-template-columns: 1.5fr 1fr 1fr 0.8fr; align-items: center; gap: 5px; margin-bottom: 8px; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 8px; }
        .score-row input { text-align: center; background: rgba(0,0,0,0.3); border: none; margin-bottom: 0; }
        .total-display { text-align: center; font-weight: 800; color: var(--text-primary); font-size: 1em; padding: 10px 0; }
        .btn-save { background: linear-gradient(45deg, var(--accent-orange), var(--accent-gold)); color: var(--bg-primary); border: none; padding: 14px; border-radius: 10px; font-weight: 800; width: 100%; margin-top: 10px; cursor: pointer; box-shadow: 0 4px 15px rgba(230, 92, 74, 0.4); position: relative; z-index: 2; }
        .btn-cancel { background: rgba(255,255,255,0.1); color: var(--text-secondary); width: 100%; padding: 12px; border-radius: 10px; margin-top: 10px; cursor: pointer; border: 1px solid var(--text-secondary); display: none; }

        .section-header { font-weight: 800; margin: 30px 0 10px 0; font-size: 1.1em; color: var(--accent-gold); border-left: 4px solid var(--accent-orange); padding-left: 10px; font-family: 'Mochiy Pop P One', cursive; text-transform: uppercase; letter-spacing: 1px; display: flex; align-items: center; gap: 8px; }
        .item-row { background: rgba(0,0,0,0.4); border: 1px solid rgba(212, 175, 55, 0.3); padding: 15px; border-radius: 12px; margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center; cursor: pointer; transition: transform 0.1s; }
        .main-score { font-size: 1.5em; font-weight: 800; line-height: 1; color: var(--accent-gold); }
        .badge-full { display: inline-block; background: rgba(74, 144, 226, 0.2); color: var(--accent-blue); padding: 2px 6px; border-radius: 4px; font-size: 0.7em; margin-top: 5px; border: 1px solid var(--accent-blue); }
        .badge-partial { display: inline-block; background: rgba(230, 92, 74, 0.2); color: var(--accent-orange); padding: 2px 6px; border-radius: 4px; font-size: 0.7em; margin-top: 5px; border: 1px solid var(--accent-orange); }
        
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 2000; display: none; justify-content: center; align-items: flex-end; backdrop-filter: blur(3px); }
        .modal-content { background: var(--bg-secondary); border-top: 3px solid var(--accent-gold); padding: 25px; border-radius: 24px 24px 0 0; width: 100%; max-width: 550px; max-height: 85vh; overflow-y: auto; color: white; animation: slideUp 0.3s ease; box-shadow: 0 -5px 20px rgba(0,0,0,0.5); }
        .detail-table { width: 100%; border-collapse: collapse; margin-top: 15px; font-size: 0.9em; }
        .detail-table th { text-align: left; color: var(--accent-gold); border-bottom: 1px solid rgba(255,255,255,0.1); padding: 8px; }
        .detail-table td { padding: 8px; border-bottom: 1px solid rgba(255,255,255,0.05); color: var(--text-secondary); }
        .val-b { color: var(--accent-blue); font-weight: bold; }
        .val-s { color: var(--accent-orange); font-weight: bold; }
        .val-k { color: #ffd32a; font-weight: bold; }
        .modal-actions { display: flex; gap: 10px; margin-top: 20px; }
        .btn-modal { flex: 1; padding: 12px; border-radius: 8px; border: none; cursor: pointer; font-weight: bold; }
        .btn-edit { background: var(--accent-blue); color: white; }
        .btn-delete { background: var(--accent-orange); color: white; }
        .empty-state { text-align: center; padding: 40px 20px; opacity: 0.9; }
        .empty-pochita { width: 150px; margin-bottom: 15px; filter: drop-shadow(0 0 5px #ff6b6b) drop-shadow(0 0 10px #feca57) brightness(1.1); }
        
        @keyframes float { 0%, 100% { transform: translateY(0) rotate(0deg); } 50% { transform: translateY(-5px) rotate(0deg); } }
    </style>
    
    <script>
        if ('serviceWorker' in navigator) {
            // Sesuai nama file di repo kamu (biar ga usah rename lagi)
            navigator.serviceWorker.register('sw-final.js').catch(err => console.log(err));
        }
    </script>
</head>
<body>

<div class="container">
    
    <div class="glass-card header-card">
        <div class="header-top">
            <div>
                <h1 class="app-title" id="displayAppName">TO UGM 2026</h1>
                <div class="quote-text" id="quoteText">Loading motivasi...</div>
            </div>
            <img src="assets/img/btn_settings.png" class="btn-settings-img" onclick="openSettings()" alt="Settings">
        </div>
        
        <div class="health-bar-container">
            <div class="health-text" id="hpText">Loading...</div>
            <div class="health-bar-fill" id="hpBar"></div>
        </div>
    </div>

    <div id="targetDisplay"></div>

    <div class="glass-card" id="inputFormCard" style="overflow: visible;">
        <h3>
            <img src="assets/img/icon_input.png" class="icon-title" onerror="this.style.display='none'">
            Input Nilai Baru
        </h3>
        <input type="hidden" id="editId">
        <div style="display:flex; gap:10px;">
            <input type="text" id="platform" list="platformHistory" placeholder="Platform (e.g. Sainsin)" autocomplete="off">
            <datalist id="platformHistory"></datalist>
            <input type="text" id="toName" placeholder="Nama TO (e.g. TO 1)">
        </div>
        <div style="display:flex; gap:10px;">
            <input type="datetime-local" id="toDate">
            <select id="status">
                <option value="Sudah Daftar">Sudah Daftar</option>
                <option value="Belum Daftar">Belum Daftar</option>
                <option value="Selesai">Selesai</option>
            </select>
        </div>
        <div style="background: rgba(212, 175, 55, 0.1); border: 1px solid var(--accent-gold); padding: 10px; border-radius: 10px; margin: 15px 0;">
            <label style="font-size:0.8em; color:var(--accent-gold); font-weight:bold; display:block; text-align:center; margin-bottom: 5px;">SKOR AKHIR (Jika Ada/Snbt.id)</label>
            <input type="number" id="officialScore" placeholder="0" style="font-size:1.5em; text-align:center; background:transparent; border:none; color:var(--accent-gold); font-weight:bold; margin:0;">
            <div style="text-align:center; font-size:0.65em; color:var(--text-secondary); margin-top:2px;">*Isi ini saja jika tidak ada rincian subtes</div>
        </div>
        <div class="manual-calc-box">
            <div style="font-size:0.8em; margin-bottom:10px; color:var(--text-secondary)">Isi Benar (B) & Kosong (K) - *Opsional</div>
            <div class="col-header">
                <div style="text-align:left">SUBTES</div>
                <div>B</div>
                <div>K</div>
                <div>TOTAL</div>
            </div>
            <div id="scoreInputsContainer"></div>
        </div>
        <button class="btn-save" id="btnSave" onclick="saveToData()">SIMPAN DATA</button>
        <button class="btn-cancel" id="btnCancel" onclick="resetForm()">BATAL EDIT</button>
    </div>

    <div id="raporSection"></div>

    <div class="glass-card" id="chartSection" style="display:none;">
        <h3 style="margin-bottom:15px;">
            <img src="assets/img/icon_analysis.png" class="icon-title">
            Tren Progress
        </h3>
        
        <div style="margin-bottom:20px;">
            <div style="font-size:0.8em; color:var(--accent-blue); margin-bottom:5px; font-weight:bold;">GRAFIK GABUNGAN</div>
            <div class="chart-wrapper">
                <canvas id="globalChart"></canvas>
            </div>
        </div>

        <div style="border-top:1px solid rgba(255,255,255,0.1); padding-top:15px;">
            <div style="font-size:0.8em; color:var(--accent-orange); margin-bottom:5px; font-weight:bold;">PER PLATFORM</div>
            <div class="chart-wrapper">
                <canvas id="platformChart"></canvas>
            </div>
        </div>
    </div>

    <div id="listsContainer"></div>
    
</div> 

<div class="footer-wrapper">
    <img src="assets/img/footer_scene.jpg" class="footer-scene-img" alt="Footer Scene">
</div>

<div class="modal-overlay" id="settingsModal">
    <div class="modal-content">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
            <h3 style="margin:0; border:none; color:var(--accent-gold);">Target Jurusan</h3>
            <button onclick="closeSettings()" style="background:none; border:none; color:var(--text-secondary); font-size:1.5em;">&times;</button>
        </div>
        <input type="text" id="userNameInput" placeholder="Nama / Judul Aplikasi">
        <div style="display:flex; flex-direction:column; gap:10px; margin-top:15px;">
            <div><label style="font-size:0.8em; color:var(--text-secondary)">Pilihan 1</label><select id="choice1"></select></div>
            <div><label style="font-size:0.8em; color:var(--text-secondary)">Pilihan 2</label><select id="choice2"></select></div>
            <div><label style="font-size:0.8em; color:var(--text-secondary)">Pilihan 3 (Vokasi)</label><select id="choice3"></select></div>
            <div><label style="font-size:0.8em; color:var(--text-secondary)">Pilihan 4 (Vokasi)</label><select id="choice4"></select></div>
        </div>
        <button class="btn-save" style="margin-top:20px;" onclick="saveSettings()">Simpan Perubahan</button>
    </div>
</div>

<div class="modal-overlay" id="detailsModal">
    <div class="modal-content">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
            <div id="detailTitle" style="font-weight:bold; color:var(--accent-gold); font-size:1.2em;">Detail TO</div>
            <button onclick="closeDetails()" style="background:none; border:none; color:var(--text-secondary); font-size:1.5em;">&times;</button>
        </div>
        <div id="detailContent"></div>
        <div class="modal-actions">
            <button class="btn-modal btn-edit" onclick="actionEdit()">Edit Data</button>
            <button class="btn-modal btn-delete" onclick="actionDelete()">Hapus</button>
        </div>
    </div>
</div>

<script>
    // --- DATABASE ---
    const MAJOR_DB = [
        { id: 0, name: "-- Pilih Prodi --", grade: 0, type: "" },
        // SAINTEK
        { id: 101, name: "Kedokteran", grade: 725, type: "S1" },
        { id: 102, name: "Kedokteran Gigi", grade: 715, type: "S1" },
        { id: 103, name: "Teknologi Informasi", grade: 715, type: "S1" },
        { id: 104, name: "Ilmu Komputer", grade: 710, type: "S1" },
        { id: 105, name: "Farmasi", grade: 710, type: "S1" },
        { id: 106, name: "Teknik Industri", grade: 705, type: "S1" },
        { id: 107, name: "Teknik Sipil", grade: 700, type: "S1" },
        { id: 108, name: "Gizi", grade: 700, type: "S1" },
        { id: 109, name: "Arsitektur", grade: 695, type: "S1" },
        { id: 110, name: "Teknik Mesin", grade: 690, type: "S1" },
        { id: 111, name: "Statistika", grade: 685, type: "S1" },
        { id: 112, name: "Teknik Elektro", grade: 685, type: "S1" },
        { id: 113, name: "Teknik Kimia", grade: 680, type: "S1" },
        { id: 114, name: "Teknik Nuklir", grade: 680, type: "S1" },
        { id: 115, name: "Teknik Geodesi", grade: 675, type: "S1" },
        { id: 116, name: "Teknik Biomedis", grade: 670, type: "S1" },
        { id: 117, name: "Matematika", grade: 665, type: "S1" },
        { id: 118, name: "Biologi", grade: 650, type: "S1" },
        { id: 119, name: "Kimia", grade: 640, type: "S1" },
        { id: 120, name: "Fisika", grade: 610, type: "S1" },
        { id: 121, name: "Ilmu & Industri Peternakan", grade: 600, type: "S1" },
        { id: 122, name: "Kehutanan", grade: 600, type: "S1" },
        // SOSHUM
        { id: 201, name: "Psikologi", grade: 720, type: "S1" },
        { id: 202, name: "Manajemen", grade: 720, type: "S1" },
        { id: 203, name: "Ilmu Komunikasi", grade: 715, type: "S1" },
        { id: 204, name: "Akuntansi", grade: 715, type: "S1" },
        { id: 205, name: "Hubungan Internasional", grade: 715, type: "S1" },
        { id: 206, name: "Hukum", grade: 710, type: "S1" },
        { id: 207, name: "Ilmu Ekonomi", grade: 690, type: "S1" },
        { id: 208, name: "Manajemen Kebijakan Publik", grade: 690, type: "S1" },
        { id: 209, name: "Sastra Inggris", grade: 680, type: "S1" },
        { id: 210, name: "Pariwisata", grade: 675, type: "S1" },
        { id: 211, name: "Filsafat", grade: 670, type: "S1" },
        { id: 212, name: "Sosiologi", grade: 660, type: "S1" },
        { id: 213, name: "Sastra Jepang", grade: 660, type: "S1" },
        { id: 214, name: "Sejarah", grade: 640, type: "S1" },
        { id: 215, name: "Sastra Jawa", grade: 600, type: "S1" },
        // VOKASI
        { id: 301, name: "Manajemen Info. Kesehatan (D4)", grade: 695, type: "D4" },
        { id: 302, name: "Akuntansi Sektor Publik (D4)", grade: 685, type: "D4" },
        { id: 303, name: "Tek. Rekayasa Perangkat Lunak (D4)", grade: 685, type: "D4" },
        { id: 304, name: "Bisnis Perjalanan Wisata (D4)", grade: 675, type: "D4" },
        { id: 305, name: "Perbankan (D4)", grade: 670, type: "D4" },
        { id: 306, name: "Manajemen Penilaian Properti (D4)", grade: 670, type: "D4" },
        { id: 307, name: "Teknologi Rekayasa Internet (D4)", grade: 660, type: "D4" },
        { id: 308, name: "Tek. Pengelolaan Pemeliharaan Infra (D4)", grade: 640, type: "D4" },
        { id: 309, name: "Teknologi Veteriner (D4)", grade: 620, type: "D4" },
        { id: 401, name: "Prodi D3 (Pilihan Luar)", grade: 600, type: "D3" }
    ];

    // CONFIG SOAL (SESUAI REQUEST: PK 20 SOAL)
    const SUBTEST_CONFIG = [
        { id: 'pu', label: 'PU', total: 30, weight: 1.0 },
        { id: 'ppu', label: 'PPU', total: 20, weight: 1.0 },
        { id: 'pbm', label: 'PBM', total: 20, weight: 1.0 },
        { id: 'pk', label: 'PK', total: 20, weight: 1.3 }, 
        { id: 'ind', label: 'B.Indo', total: 30, weight: 1.0 },
        { id: 'ing', label: 'B.Ing', total: 20, weight: 1.0 },
        { id: 'pm', label: 'PM', total: 20, weight: 1.2 } 
    ];

    const QUOTES = [
        "Tunjukkan padaku mimpimu memakai almamater itu. — (Pochita)",
        "Aku ingin mendengar ceritamu tentang indahnya masa kuliah nanti. — (Pochita)",
        "Jantungku sekarang adalah milikmu. Pakailah untuk belajar. — (Pochita)",
        "Hiduplah, dan wujudkan impianmu. — (Pochita)",
        "Woi! Kalau mau hidup enak, habisin dulu soal-soal ini! — (Denji)",
        "Aku cuma pengen hidup normal... jadi mahasiswa UGM Kamu juga kan? — (Denji)",
        "Berlututlah wahai soal susah! Sang Power yang jenius akan melibasmu! — (Power)",
        "Jangan takut! Ada aku yang hebat ini. UTBK itu kecil! — (Power)",
        "Ubah rasa takut gagalmu menjadi senjata! — (Asa Mitaka)",
        "Mulai sekarang, belajarlah sedikit lebih egois demi masa depanmu. — (Asa Mitaka)",
        "Easy revenge! Ayo balas dendam ke nilai tryout yang kemarin. — (Aki Hayakawa)"
    ];

    let userProfile = { name: "TO UGM 2026", choices: [101, 0, 0, 0] };
    let isEditing = false;
    let selectedItemId = null;
    let globalChartInstance = null;
    let platformChartInstance = null;

    document.addEventListener('DOMContentLoaded', () => {
        fixDataTypes(); 
        generateInputs();
        loadProfile();
        loadData(); // Ini juga bakal panggil charts
        displayQuote();
        loadPlatformHistory();
        startCountdown();
    });

// --- CHART LOGIC TERBARU (SEQUENTIAL) ---
    function renderCharts(data) {
        // Ambil data yang statusnya 'Selesai', urutkan berdasarkan Tanggal pengerjaan
        const finishedTOs = data.filter(i => i.status === 'Selesai').sort((a,b) => new Date(a.date) - new Date(b.date));
        
        const chartSec = document.getElementById('chartSection');
        if(finishedTOs.length < 2) {
            chartSec.style.display = 'none'; 
            return;
        }
        chartSec.style.display = 'block';

        // --- 1. SETUP GRAFIK GLOBAL (URUT WAKTU) ---
        // Labelnya kita buat simpel: Nama Platform + Nama TO (Tanpa Tanggal biar ga bingung)
        const globalLabels = finishedTOs.map(i => `${i.platform} - ${i.toName}`);
        const globalScores = finishedTOs.map(i => i.officialScore > 0 ? i.officialScore : i.calcScore);

        const ctxGlobal = document.getElementById('globalChart').getContext('2d');
        if(globalChartInstance) globalChartInstance.destroy();

        globalChartInstance = new Chart(ctxGlobal, {
            type: 'line',
            data: {
                labels: globalLabels, // Label urut sesuai pengerjaan
                datasets: [{
                    label: 'Skor',
                    data: globalScores,
                    borderColor: '#D4AF37', // Warna Emas
                    backgroundColor: 'rgba(212, 175, 55, 0.1)',
                    borderWidth: 3,
                    pointBackgroundColor: '#fff',
                    pointRadius: 5, // Titik agak besar biar jelas
                    pointHoverRadius: 7,
                    tension: 0.3, // Garis agak melengkung dikit
                    fill: true
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { display: false } }, // Hilangkan legenda "Skor"
                scales: {
                    y: { 
                        grid: { color: 'rgba(255,255,255,0.1)' }, 
                        ticks: { color: '#ccc' },
                        suggestedMin: 400 // Biar grafik ga mulai dari 0 (lebih fokus)
                    },
                    x: { 
                        grid: { display: false }, 
                        ticks: { display: false } // Hilangkan tulisan bawah biar bersih (karena sudah ada tooltip)
                    }
                },
                interaction: {
                    intersect: false,
                    mode: 'index',
                },
            }
        });

        // --- 2. SETUP GRAFIK PER PLATFORM (START SAMA) ---
        
        // Langkah A: Kelompokkan nilai per platform
        let platforms = {};
        finishedTOs.forEach(i => {
            if(!platforms[i.platform]) platforms[i.platform] = [];
            // Kita cuma butuh nilainya saja, urut dari yang pertama dikerjakan
            platforms[i.platform].push(i.officialScore > 0 ? i.officialScore : i.calcScore);
        });

        // Langkah B: Cari siapa yang paling rajin (TO terbanyak) buat nentuin panjang sumbu X
        let maxCount = 0;
        for (let p in platforms) {
            if (platforms[p].length > maxCount) maxCount = platforms[p].length;
        }

        // Langkah C: Bikin label sumbu X (TO Ke-1, TO Ke-2, dst)
        let platformLabels = [];
        for(let i=1; i<=maxCount; i++) platformLabels.push("TO Ke-" + i);

        // Langkah D: Siapkan Datasets warna-warni
        const colors = ['#4A90E2', '#ff4757', '#2ed573', '#eccc68', '#ffa502', '#d1ccc0'];
        let datasets = [];
        let colorIdx = 0;

        for (let p in platforms) {
            datasets.push({
                label: p,
                data: platforms[p], // Data otomatis masuk ke index 0, 1, 2... (Start kiri)
                borderColor: colors[colorIdx % colors.length],
                backgroundColor: colors[colorIdx % colors.length],
                borderWidth: 2,
                tension: 0.2,
                pointRadius: 4,
                pointHoverRadius: 6
            });
            colorIdx++;
        }

        const ctxPlatform = document.getElementById('platformChart').getContext('2d');
        if(platformChartInstance) platformChartInstance.destroy();

        platformChartInstance = new Chart(ctxPlatform, {
            type: 'line',
            data: {
                labels: platformLabels, // Sumbu X: TO Ke-1, TO Ke-2...
                datasets: datasets
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { 
                    legend: { labels: { color: '#fff', boxWidth: 10, font:{size:11} } },
                    tooltip: {
                        callbacks: {
                            title: function(context) {
                                return context[0].label; // Judul Tooltip: "TO Ke-X"
                            }
                        }
                    }
                },
                scales: {
                    y: { 
                        grid: { color: 'rgba(255,255,255,0.1)' }, 
                        ticks: { color: '#ccc' } 
                    },
                    x: { 
                        grid: { color: 'rgba(255,255,255,0.05)' }, 
                        ticks: { color: '#aaa', font:{size:10} } // Tampilkan tulisan "TO Ke-1"
                    }
                }
            }
        });
    }


    // --- CORE LOGIC ---
    function startCountdown() {
        const target = new Date("2026-04-21T00:00:00").getTime();
        setInterval(() => {
            const now = new Date().getTime();
            const diff = target - now;
            const days = Math.floor(diff / (1000 * 60 * 60 * 24));
            document.getElementById("hpText").innerText = diff < 0 ? "UTBK Telah Dimulai!" : `HP: ${days} Hari Lagi`;
            let percent = (days / 500) * 100;
            if(percent > 100) percent = 100;
            document.getElementById("hpBar").style.width = percent + "%";
            
            let color = days < 60 ? "#e84118" : (days < 150 ? "#fbc531" : "#4cd137");
            document.getElementById("hpBar").style.background = color; 
        }, 1000);
    }

    function fixDataTypes() {
        let d = JSON.parse(localStorage.getItem('sicolokDataV7'));
        if (d && Array.isArray(d)) {
            let fixed = false;
            d = d.map(item => {
                if (typeof item.id !== 'string') { item.id = String(item.id); fixed = true; }
                return item;
            });
            if (fixed) localStorage.setItem('sicolokDataV7', JSON.stringify(d));
        }
    }

    function displayQuote() {
        document.getElementById('quoteText').innerText = QUOTES[Math.floor(Math.random() * QUOTES.length)];
    }

    function generateInputs() {
        const c = document.getElementById('scoreInputsContainer'); c.innerHTML = '';
        SUBTEST_CONFIG.forEach(s => {
            c.innerHTML += `
            <div class="score-row">
                <div class="score-label">${s.label}</div>
                <input type="tel" id="b_${s.id}" placeholder="-" oninput="validateInput('${s.id}')">
                <input type="tel" id="k_${s.id}" placeholder="-" style="color:var(--accent-orange)" oninput="validateInput('${s.id}')">
                <div class="total-display">${s.total}</div>
                <input type="hidden" id="t_${s.id}" value="${s.total}">
            </div>`;
        });
    }

    function validateInput(id) {
        const b = parseInt(document.getElementById('b_'+id).value)||0;
        const k = parseInt(document.getElementById('k_'+id).value)||0;
        const t = parseInt(document.getElementById('t_'+id).value);
        if(b+k > t) document.getElementById('b_'+id).value = ""; 
    }

    function loadPlatformHistory() {
        const history = JSON.parse(localStorage.getItem('platformHistory')) || [];
        const dl = document.getElementById('platformHistory');
        dl.innerHTML = history.map(h => `<option value="${h}">`).join('');
    }

    function saveToData() {
        const pf = document.getElementById('platform').value;
        const tn = document.getElementById('toName').value;
        if(!pf || !tn) { alert("Isi Platform & Nama TO dulu!"); return; }

        let history = JSON.parse(localStorage.getItem('platformHistory')) || [];
        if(!history.includes(pf)) {
            history.push(pf);
            localStorage.setItem('platformHistory', JSON.stringify(history));
            loadPlatformHistory();
        }

        let totalRaw=0, maxW=0, sub={};
        let offScore = parseInt(document.getElementById('officialScore').value)||0;

        SUBTEST_CONFIG.forEach(s => {
            const bVal = document.getElementById('b_'+s.id).value;
            if(bVal === "") return; 
            const b = parseInt(bVal)||0;
            const k = parseInt(document.getElementById('k_'+s.id).value)||0;
            sub[s.id] = {b, k, t:s.total};
            if(s.total > 0) {
                totalRaw += (b/s.total) * 1000 * s.weight;
                maxW += 1000 * s.weight;
            }
        });

        let calc = maxW > 0 ? Math.round(180 + (totalRaw/maxW * 820)) : 0;
        const entryId = isEditing ? document.getElementById('editId').value : String(Date.now());

        const entry = {
            id: entryId, platform: pf, toName: tn,
            date: document.getElementById('toDate').value,
            status: document.getElementById('status').value,
            subtestScores: sub, calcScore: calc, officialScore: offScore
        };

        let d = JSON.parse(localStorage.getItem('sicolokDataV7')) || [];
        if(isEditing) {
            const idx = d.findIndex(x => String(x.id) === String(entryId));
            if(idx !== -1) d[idx] = entry;
        } else d.push(entry);

        localStorage.setItem('sicolokDataV7', JSON.stringify(d));
        resetForm(); loadData();
    }

    function loadRapor() {
        const d = JSON.parse(localStorage.getItem('sicolokDataV7')) || [];
        const finished = d.filter(i => i.status === 'Selesai');
        const raporContainer = document.getElementById('raporSection');

        if (finished.length === 0) { raporContainer.innerHTML = ''; return; }

        // UPDATE LOGIC: Masukkan jika Full Subtes ATAU punya Official Score
        let validTOs = finished.filter(item => {
            // Cek 1: Punya official score (misal Snbt.id)
            if (item.officialScore && item.officialScore > 0) return true;
            
            // Cek 2: Punya kalkulasi subtes lengkap
            if(!item.subtestScores) return false;
            let count = 0;
            for(let key in item.subtestScores) if(item.subtestScores[key].t > 0) count++;
            return count === 7;
        });

        let totalHtml = '';
        if(validTOs.length > 0) {
            let totalScore = 0;
            validTOs.forEach(i => totalScore += (i.officialScore > 0 ? i.officialScore : i.calcScore));
            let avgScore = Math.round(totalScore / validTOs.length);
            
            let targetScore = 0;
            if (userProfile.choices[0] > 0) {
                let m = MAJOR_DB.find(x => x.id == userProfile.choices[0]);
                targetScore = m.grade;
            }

            let statusColor = '--accent-orange';
            let statusText = 'Kejar Lagi!';
            if (avgScore >= targetScore && targetScore > 0) { statusColor = '--accent-blue'; statusText = 'Mantap!'; }
            else if (avgScore >= targetScore - 50 && targetScore > 0) { statusColor = '--accent-gold'; statusText = 'Dikit Lagi!'; }

            totalHtml = `
            <div class="glass-card" style="text-align:center; border: 2px solid var(${statusColor}); padding: 15px;">
                <h3 style="margin:0; border:none; font-size:1em; justify-content:center;">
                    <img src="assets/img/icon_analysis.png" class="icon-title">
                    Rata-rata Skor (All TO)
                </h3>
                <div style="display:flex; justify-content:center; align-items:center; gap:20px; margin-top:10px;">
                    <div><div style="font-size:0.7em; color:var(--text-secondary)">Rerata Kamu</div><div style="font-size:1.8em; font-weight:bold; color:var(${statusColor})">${avgScore}</div></div>
                    <div style="font-size:1.2em; color:var(--text-secondary)">vs</div>
                    <div><div style="font-size:0.7em; color:var(--text-secondary)">Target</div><div style="font-size:1.5em; font-weight:bold; color:var(--text-primary)">${targetScore}</div></div>
                </div>
                <div style="font-size:0.8em; color:var(${statusColor}); font-weight:bold; margin-top:5px;">${statusText}</div>
            </div>`;
        }

        let subtestHtml = `<div class="rapor-grid">`;
        SUBTEST_CONFIG.forEach(sub => {
            let totalBenar = 0;
            let totalSoal = 0;
            
            // Hanya ambil statistik subtes dari TO yang punya rincian subtes
            finished.forEach(item => {
                if(item.subtestScores && item.subtestScores[sub.id] && item.subtestScores[sub.id].t > 0) {
                    totalBenar += item.subtestScores[sub.id].b;
                    totalSoal += item.subtestScores[sub.id].t;
                }
            });

            if(totalSoal > 0) {
                let percent = Math.round((totalBenar / totalSoal) * 100);
                
                let color = '#ff4757'; 
                let chibiImg = 'assets/img/score_bad.png'; 
                if (percent >= 70) { color = '#3742fa'; chibiImg = 'assets/img/score_good.png'; } 
                else if (percent >= 40) { color = '#eccc68'; chibiImg = 'assets/img/score_mid.png'; }
                
                subtestHtml += `
                <div class="subtest-card">
                    <div class="subtest-title">${sub.label}</div>
                    <div class="circular-chart" style="background: conic-gradient(${color} ${percent}%, transparent ${percent}% 100%);">
                        <div class="chibi-container">
                            <img src="${chibiImg}" class="chibi-face" onerror="this.style.display='none'">
                        </div>
                        <div class="percent-badge" style="background:${color}; box-shadow: 0 0 5px ${color}">${percent}%</div>
                    </div>
                </div>`;
            }
        });
        subtestHtml += `</div>`;

        raporContainer.innerHTML = totalHtml + (finished.length > 0 ? `
        <div class="glass-card" style="margin-top:20px;">
            <h3 style="border:none; margin:0; text-align:center; justify-content:center;">
                <img src="assets/img/icon_analysis.png" class="icon-title">
                Analisis Subtes
            </h3>
            ${subtestHtml}
        </div>` : '');
    }

    function loadData() {
        const d = JSON.parse(localStorage.getItem('sicolokDataV7')) || [];
        const c = document.getElementById('listsContainer');
        
        loadRapor(); 
        renderCharts(d); // Panggil fungsi render chart di sini

        if(d.length === 0) {
            c.innerHTML = `
            <div class="empty-state">
                <img src="assets/img/pochita_sleep.png" class="empty-pochita" onerror="this.style.display='none'">
                <p>Belum ada data TO. Yuk mulai!</p>
            </div>`;
            return;
        }

        const sorted = d.sort((a,b) => new Date(b.date) - new Date(a.date)); 
        let html = '';
        const priorities = sorted.filter(i => i.status === 'Sudah Daftar');
        const plans = sorted.filter(i => i.status === 'Belum Daftar');
        const history = sorted.filter(i => i.status === 'Selesai');

        if (priorities.length > 0) {
            html += `<div class="section-header"><img src="assets/img/icon_history.png" class="icon-title"> PRIORITAS</div>`;
            priorities.forEach(i => { html += renderItem(i); });
        }
        if (plans.length > 0) {
            html += `<div class="section-header"><img src="assets/img/icon_input.png" class="icon-title"> RENCANA</div>`;
            plans.forEach(i => { html += renderItem(i); });
        }
        if (history.length > 0) {
            html += `<div class="section-header"><img src="assets/img/icon_history.png" class="icon-title"> RIWAYAT SELESAI</div>`;
            history.forEach(i => { html += renderItem(i); });
        }
        c.innerHTML = html;
    }

    function renderItem(i) {
        let rightSideHTML = '';
        if (i.status === 'Selesai') {
            let score = i.officialScore > 0 ? i.officialScore : i.calcScore;
            let color = score >= 700 ? 'var(--accent-blue)' : (score >= 600 ? 'var(--accent-gold)' : 'var(--accent-orange)');
            rightSideHTML = `
                <div class="main-score" style="color:${color}">${score}</div>
                <div style="font-size:0.75em; color:var(--text-secondary); text-align:right">${i.status}</div>
            `;
        } else {
            const today = new Date();
            const targetDate = new Date(i.date);
            const diffTime = targetDate - today;
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            let dayLabel = "", dayColor = "var(--text-secondary)";
            if (isNaN(diffDays)) { dayLabel = "-"; } 
            else if (diffDays < 0) { dayLabel = "Lewat"; dayColor = "var(--accent-orange)"; } 
            else if (diffDays === 0) { dayLabel = "Hari Ini!"; dayColor = "var(--accent-gold)"; } 
            else { dayLabel = `${diffDays} Hari Lagi`; dayColor = diffDays <= 3 ? "var(--accent-orange)" : "var(--accent-blue)"; }
            rightSideHTML = `
                <div style="font-weight:bold; font-size:1.1em; color:${dayColor}; text-align:right">${dayLabel}</div>
                <div style="font-size:0.75em; color:var(--text-secondary); text-align:right">${i.status}</div>
            `;
        }
        
        let labelHTML = '';
        // LOGIKA BARU UNTUK LABEL FULL TO
        let hasSubtest = false;
        if(i.subtestScores) {
            let count=0;
            for(let k in i.subtestScores) if(i.subtestScores[k].t > 0) count++;
            if(count===7) hasSubtest = true;
        }

        if (i.officialScore > 0 && !hasSubtest) {
            labelHTML = `<span class="badge-full">Full Score</span>`;
        } else if (hasSubtest) {
            labelHTML = `<span class="badge-full">Full Analysis</span>`;
        } else if (i.subtestScores) {
            let takenSub = [];
            for(let [k, v] of Object.entries(i.subtestScores)) if(v.t > 0) takenSub.push(SUBTEST_CONFIG.find(s=>s.id==k).label);
            if(takenSub.length > 0) labelHTML = `<span class="badge-partial">Parsial: ${takenSub.join(', ')}</span>`;
            else labelHTML = `<span style="font-size:0.7em; color:#777;">Manual</span>`;
        }

        return `
        <div class="item-row" onclick="openDetails('${i.id}')">
            <div>
                <div style="font-weight:bold; color:var(--accent-gold)">${i.platform}</div>
                <div style="font-size:0.9em">${i.toName}</div>
                <div style="font-size:0.75em; color:var(--text-secondary)">${i.date ? new Date(i.date).toLocaleDateString() : '-'}</div>
                ${labelHTML}
            </div>
            <div>${rightSideHTML}</div>
        </div>`;
    }

    function openDetails(id) {
        selectedItemId = String(id);
        const d = JSON.parse(localStorage.getItem('sicolokDataV7'));
        const item = d.find(x => String(x.id) === selectedItemId);
        if(!item) { alert("Error: Data tidak sinkron."); return; }
        document.getElementById('detailTitle').innerText = `${item.platform} - ${item.toName}`;
        
        let contentHTML = '';
        if (item.officialScore > 0) {
            contentHTML += `<div style="text-align:center; padding:15px; border-bottom:1px solid rgba(255,255,255,0.1);">
                <div style="font-size:0.8em; color:var(--text-secondary)">Skor Akhir (Tanpa Rincian)</div>
                <div style="font-size:2.5em; font-weight:bold; color:var(--accent-gold)">${item.officialScore}</div>
            </div>`;
        }

        let tableHTML = `<table class="detail-table"><thead><tr><th>Subtes</th><th>Benar</th><th>Salah</th><th>Kosong</th></tr></thead><tbody>`;
        let hasData = false;
        if (item.subtestScores) {
            SUBTEST_CONFIG.forEach(s => {
                if (item.subtestScores[s.id]) {
                    const d = item.subtestScores[s.id];
                    if (d.t > 0) {
                        tableHTML += `<tr><td>${s.label}</td><td class="val-b">${d.b}</td><td class="val-s">${d.t-(d.b+d.k)}</td><td class="val-k">${d.k}</td></tr>`;
                        hasData = true;
                    }
                }
            });
        }
        tableHTML += `</tbody></table>`;
        
        if(hasData) contentHTML += tableHTML;
        else if(!item.officialScore) contentHTML += `<div style="text-align:center; padding:20px;">Belum ada data nilai.</div>`;

        document.getElementById('detailContent').innerHTML = contentHTML;
        document.getElementById('detailsModal').style.display = 'flex';
    }

    function closeDetails() {
        document.getElementById('detailsModal').style.display = 'none';
        selectedItemId = null;
    }

    function actionEdit() {
        if(selectedItemId) { const idToEdit = selectedItemId; closeDetails(); editItem(idToEdit); }
    }

    function actionDelete() {
        if(selectedItemId && confirm("Yakin hapus?")) {
            let d = JSON.parse(localStorage.getItem('sicolokDataV7')) || [];
            d = d.filter(x => String(x.id) !== String(selectedItemId));
            localStorage.setItem('sicolokDataV7', JSON.stringify(d));
            closeDetails();
            loadData();
        }
    }

    function editItem(id) {
        const d = JSON.parse(localStorage.getItem('sicolokDataV7'));
        const item = d.find(x => String(x.id) === String(id));
        if (!item) { alert("Data tidak ditemukan di database!"); return; }
        isEditing = true;
        document.getElementById('editId').value = item.id;
        document.getElementById('platform').value = item.platform;
        document.getElementById('toName').value = item.toName;
        document.getElementById('toDate').value = item.date;
        document.getElementById('status').value = item.status;
        document.getElementById('officialScore').value = item.officialScore || "";
        document.getElementById('btnSave').innerText = "UPDATE DATA";
        document.getElementById('btnCancel').style.display = 'block';
        document.querySelectorAll('input[type="tel"]').forEach(i => i.value = "");
        if(item.subtestScores) {
            for(let [k,v] of Object.entries(item.subtestScores)) {
                let bEl = document.getElementById('b_'+k);
                let kEl = document.getElementById('k_'+k);
                if(bEl && kEl) { bEl.value = v.b; kEl.value = v.k; }
            }
        }
        document.getElementById('inputFormCard').scrollIntoView({ behavior: 'smooth', block: 'center' });
    }

    function resetForm() {
        isEditing = false;
        document.getElementById('editId').value = "";
        document.querySelectorAll('input[type="tel"]').forEach(i => i.value = "");
        document.getElementById('officialScore').value = "";
        document.getElementById('platform').value = "";
        document.getElementById('toName').value = "";
        document.getElementById('btnSave').innerText = "SIMPAN DATA";
        document.getElementById('btnCancel').style.display = 'none';
    }

    function openSettings() {
        const m = document.getElementById('settingsModal');
        const ids = ['choice1','choice2','choice3','choice4'];
        let html = `<option value="0">-- Pilih --</option>`;
        html += `<optgroup label="SAINTEK">` + MAJOR_DB.filter(x=>x.id>=100 && x.id<200).map(x=>`<option value="${x.id}">${x.name}</option>`).join('') + `</optgroup>`;
        html += `<optgroup label="SOSHUM">` + MAJOR_DB.filter(x=>x.id>=200 && x.id<300).map(x=>`<option value="${x.id}">${x.name}</option>`).join('') + `</optgroup>`;
        html += `<optgroup label="VOKASI (D4)">` + MAJOR_DB.filter(x=>x.id>=300 && x.id<400).map(x=>`<option value="${x.id}">${x.name}</option>`).join('') + `</optgroup>`;
        html += `<optgroup label="VOKASI (D3)">` + MAJOR_DB.filter(x=>x.id>=401).map(x=>`<option value="${x.id}">${x.name}</option>`).join('') + `</optgroup>`;
        ids.forEach((id, idx) => {
            const el = document.getElementById(id);
            if(el) { el.innerHTML = html; el.value = userProfile.choices[idx]; }
        });
        document.getElementById('userNameInput').value = userProfile.name;
        m.style.display = 'flex';
    }

    function closeSettings() { document.getElementById('settingsModal').style.display = 'none'; }

    function saveSettings() {
        userProfile.name = document.getElementById('userNameInput').value || "TO UGM 2026";
        userProfile.choices = [
            parseInt(document.getElementById('choice1').value),
            parseInt(document.getElementById('choice2').value),
            parseInt(document.getElementById('choice3').value),
            parseInt(document.getElementById('choice4').value)
        ];
        localStorage.setItem('sicolokProfileV7', JSON.stringify(userProfile));
        closeSettings();
        loadProfile();
        loadRapor();
    }

    function loadProfile() {
        let s = localStorage.getItem('sicolokProfileV7');
        if(s) userProfile = JSON.parse(s);
        document.getElementById('displayAppName').innerText = userProfile.name;
        
        const c = document.getElementById('targetDisplay');
        let html = '';
        
        if(userProfile.choices[0] > 0) {
            let m = MAJOR_DB.find(x => x.id == userProfile.choices[0]);
            html += `
            <div class="target-card-contract">
                <div class="target-info">
                    <div class="target-label">★ PRIORITY TARGET</div>
                    <div class="target-prodi">${m.name}</div>
                    <div class="target-univ">Universitas Gadjah Mada</div>
                </div>
                <div class="target-score-box">
                    <span class="score-label-small">REQUIRED</span>
                    <span class="score-value-big">${m.grade}</span>
                </div>
            </div>`;
        } else {
             html += `
            <div class="glass-card" style="text-align:center; padding:15px; margin-bottom:0;">
                <div class="prodi-name" style="color:var(--text-secondary);">Belum ada target</div>
            </div>`;
        }
        c.innerHTML = html;
    }
</script>
</body>
</html>
